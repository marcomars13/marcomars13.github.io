<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Fractus Demo â€” Powered by Fractys</title>
  <meta name="description" content="Scientific benchmark and visual demonstration of the Fractus Algorithm â€” Fractus vs Plonk comparison.">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="/styles.css">
  <link rel="stylesheet" href="/demo.css">
</head>

<body class="fractus-access">
  <nav>
    <div class="brand">
      <img src="/logo.png" alt="Fractys logo"/>
      <span>Fractys (FTS)</span>
    </div>
    <div class="links">
      <a href="/index.html">Home</a>
      <a href="/fractus-access.html">Fractus Access</a>
      <a href="/airdrop.html">Airdrop</a>
      <a href="/fractus-demo.html" class="active">Demo</a>
    </div>
  </nav>

  <header class="demo-hero">
    <div class="hero-inner">
      <h1>ðŸ§  Fractus Scientific Demo</h1>
      <p class="subtitle">Benchmark Plonk vs Fractus â€” 5 000 Mapillary images (France)</p>
    </div>
  </header>

  <main class="demo-container">

    <!-- === BENCHMARK SECTION === -->
    <section class="lab-section">
      <h2 class="lab-title">Benchmark Plonk vs Fractus â€” 5 000 Mapillary Geotagged Images</h2>
      <div class="lab-grid">
        <div class="lab-card">
          <h4>Average Error (km)</h4>
          <canvas id="c_bench" class="lab-canvas"></canvas>
          <div class="lab-legend">
            <div>Plonk: <span class="val" id="lg_plonk">1252 km</span></div>
            <div>Fractus: <span class="val" id="lg_fractus">870 km</span></div>
            <div>Gain: <span class="val" id="lg_gain">âˆ’30.5 %</span></div>
          </div>
        </div>

        <div class="lab-card">
          <h4>Entropy & Coherence</h4>
          <canvas id="c_entropy" class="lab-canvas"></canvas>
          <div class="lab-legend">
            <div>Entropy: <span class="val" id="entropyVal">0.032</span></div>
            <div>Coherence: <span class="val" id="coherenceVal">98.4 %</span></div>
          </div>
        </div>

        <div class="lab-card">
          <h4>Fractal Stability â€” Std Dev (km)</h4>
          <canvas id="c_stability" class="lab-canvas"></canvas>
          <div class="lab-legend">
            <div>Plonk Ïƒ: <span class="val">92.7 km</span></div>
            <div>Fractus Ïƒ: <span class="val" id="stabilityVal">90.6 km</span></div>
          </div>
        </div>

        <div class="lab-card">
          <h4>Processing Efficiency</h4>
          <canvas id="c_eff" class="lab-canvas"></canvas>
          <div class="lab-legend">
            <div>Efficiency: <span class="val" id="efficiencyVal">Ã— 1.30</span></div>
            <div>Status: <span class="val">Stable</span></div>
          </div>
        </div>
      </div>

      <!-- === FRACTUS ENGINE VISUAL === -->
      <div class="fractus-visual">
        <h2>âš¡ Fractus Engine â€” Real-Time Stability Monitor</h2>
        <canvas id="fractusCanvas"></canvas>
        <div class="live-monitor">
          <div>ðŸŒ€ Entropy: <span id="m_entropy">0.032</span></div>
          <div>ðŸ”— Coherence: <span id="m_coherence">98.4 %</span></div>
          <div>âš¡ Efficiency: <span id="m_efficiency">Ã— 1.30</span></div>
          <div>ðŸ“ˆ Stability: <span id="m_stability">Ïƒ = 90.6 km</span></div>
        </div>
      </div>
    </section>

    <section class="lab-section">
      <h2 class="lab-title">Benchmark Logs â€” Anomaly Detection on 50 000 Entries</h2>
      <div class="lab-grid">
        <div class="lab-card"><h4>Detection Rate (%)</h4><canvas id="c_log_rate" class="lab-canvas"></canvas></div>
        <div class="lab-card"><h4>False Positive Rate (%)</h4><canvas id="c_log_fp" class="lab-canvas"></canvas></div>
        <div class="lab-card"><h4>Mean Detection Latency (ms)</h4><canvas id="c_log_latency" class="lab-canvas"></canvas></div>
        <div class="lab-card"><h4>Accuracy / Throughput</h4><canvas id="c_log_acc" class="lab-canvas"></canvas></div>
      </div>
    </section>
  </main>

  <footer>Â© 2025 Fractys â€” Created by Marc Cedrych â€” Built on Solana</footer>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    /* ---------- utils ---------- */
    const clamp=(v,a,b)=>Math.max(a,Math.min(b,v));
    const lerp=(a,b,t)=>a+(b-a)*t;
    const easeOutExpo=t=>t>=1?1:1-Math.pow(2,-10*t);

    function prepCanvas(c,w,h){
      const dpr=window.devicePixelRatio||1;
      const cssW=w??(c.clientWidth||300);
      const cssH=h??(c.clientHeight||150);
      c.width=Math.max(1,Math.floor(cssW*dpr));
      c.height=Math.max(1,Math.floor(cssH*dpr));
      const ctx=c.getContext("2d");
      ctx.setTransform(dpr,0,0,dpr,0,0);
      return{ctx,cssW,cssH};
    }

    /* ---------- state ---------- */
    const METRICS={entropy:0.032,coherence:98.4,efficiency:1.30,stability:90.6};
    const BENCH={plonk_km:1252,fractus_km:870};
    const SIGMA={plonk:92.7};

    function writeLegends(){
      document.getElementById('lg_plonk').textContent=`${BENCH.plonk_km} km`;
      document.getElementById('lg_fractus').textContent=`${BENCH.fractus_km} km`;
      const gain=(BENCH.plonk_km-BENCH.fractus_km)/BENCH.plonk_km*100;
      const lg=document.getElementById('lg_gain');
      lg.textContent=`${gain<0?'âˆ’':''}${Math.abs(gain).toFixed(1)} %`;
      lg.style.color=gain>0?'#7fffd4':'#ffe680';

      document.getElementById('entropyVal').textContent=METRICS.entropy.toFixed(3);
      document.getElementById('coherenceVal').textContent=`${METRICS.coherence.toFixed(1)} %`;
      document.getElementById('stabilityVal').textContent=`${METRICS.stability.toFixed(1)} km`;
      document.getElementById('efficiencyVal').textContent=`Ã— ${METRICS.efficiency.toFixed(2)}`;

      document.getElementById('m_entropy').textContent=METRICS.entropy.toFixed(3);
      document.getElementById('m_coherence').textContent=`${METRICS.coherence.toFixed(1)} %`;
      document.getElementById('m_stability').textContent=`Ïƒ = ${METRICS.stability.toFixed(1)} km`;
      document.getElementById('m_efficiency').textContent=`Ã— ${METRICS.efficiency.toFixed(2)}`;
    }
    writeLegends();

    /* ---------- CARD WIDGETS ---------- */

    // 1) Average Error â€” comparator widget (deux barres + shimmer)
    function makeBenchWidget(id){
      const c=document.getElementById(id); if(!c) return ()=>{};
      let g=prepCanvas(c);
      function resize(){ g=prepCanvas(c); }
      window.addEventListener('resize',resize);

      const t0=performance.now();
      return function draw(now){
        const {ctx,cssW,cssH}=g;
        ctx.clearRect(0,0,cssW,cssH);

        // fond
        const grd=ctx.createLinearGradient(0,0,0,cssH);
        grd.addColorStop(0,'rgba(127,255,212,0.04)');
        grd.addColorStop(1,'rgba(127,255,212,0.00)');
        ctx.fillStyle='#0b0f10'; ctx.fillRect(0,0,cssW,cssH);
        ctx.fillStyle=grd; ctx.fillRect(0,0,cssW,cssH);

        const max=Math.max(BENCH.plonk_km,BENCH.fractus_km)*1.15;
        const pad=12, yMid=cssH*0.62;
        const t=(now-t0)/1000;
        const pA=easeOutExpo(clamp((t-0.0)/0.9,0,1));
        const pB=easeOutExpo(clamp((t-0.35)/0.9,0,1));

        const wA=(BENCH.fractus_km/max)*(cssW-pad*2)*pA;
        const wB=(BENCH.plonk_km/max)*(cssW-pad*2)*pB;

        // barres
        ctx.fillStyle='rgba(255,80,80,0.85)'; ctx.fillRect(pad,yMid,wB,20);
        ctx.fillStyle='rgba(127,255,212,0.9)'; ctx.fillRect(pad,yMid-30,wA,20);

        // shimmer
        const sX=(now*0.15)%((cssW-pad*2)+80)-80;
        ctx.save();
        ctx.globalCompositeOperation='lighter';
        const sh=ctx.createLinearGradient(sX,0,sX+80,0);
        sh.addColorStop(0,'rgba(255,255,255,0)');
        sh.addColorStop(0.5,'rgba(255,255,255,0.25)');
        sh.addColorStop(1,'rgba(255,255,255,0)');
        ctx.fillStyle=sh;
        ctx.fillRect(pad,yMid-30,Math.max(wA,wB),50);
        ctx.restore();

        // labels
        ctx.fillStyle='#9adfce'; ctx.font='12px ui-sans-serif';
        ctx.fillText(`Fractus: ${BENCH.fractus_km} km`, pad, yMid-12);
        ctx.fillText(`Plonk: ${BENCH.plonk_km} km`, pad, yMid+35);
      };
    }

    // 2) Entropy & Coherence â€” mini-oscilloscope 2 pistes
    function makeEntropyWidget(id){
      const c=document.getElementById(id); if(!c) return ()=>{};
      let g=prepCanvas(c);
      function resize(){ g=prepCanvas(c); }
      window.addEventListener('resize',resize);

      return function draw(now){
        const {ctx,cssW,cssH}=g;
        ctx.clearRect(0,0,cssW,cssH);
        ctx.fillStyle='#0b0f10'; ctx.fillRect(0,0,cssW,cssH);

        // grille subtile
        ctx.strokeStyle='rgba(127,255,212,0.08)'; ctx.lineWidth=1;
        ctx.beginPath();
        for(let x=0;x<cssW;x+=Math.max(16,cssW/20)){ ctx.moveTo(x,8); ctx.lineTo(x,cssH-8); }
        for(let y=0;y<cssH;y+=Math.max(16,cssH/10)){ ctx.moveTo(8,y); ctx.lineTo(cssW-8,y); }
        ctx.stroke();

        // entropy signal
        const baseE=METRICS.entropy;
        ctx.strokeStyle='rgba(127,200,255,0.9)'; ctx.lineWidth=1.6;
        ctx.beginPath();
        for(let x=0;x<cssW;x++){
          const t=(x/cssW)*6.283 + now*0.0035;
          const y=cssH*0.30 + Math.sin(t)*8 + Math.sin(t*0.7+1.3)*3;
          if(x===0) ctx.moveTo(x+8,y); else ctx.lineTo(x+8,y);
        }
        ctx.stroke();
        ctx.fillStyle='rgba(127,200,255,0.25)'; ctx.fillRect(8,cssH*0.30-1,cssW-16,2);

        // coherence signal
        ctx.strokeStyle='rgba(127,255,212,0.9)';
        ctx.beginPath();
        for(let x=0;x<cssW;x++){
          const t=(x/cssW)*6.283 + now*0.0025;
          const y=cssH*0.72 + Math.sin(t)*4 + Math.sin(t*1.3+0.6)*1.5;
          if(x===0) ctx.moveTo(x+8,y); else ctx.lineTo(x+8,y);
        }
        ctx.stroke();
      };
    }

    // 3) Stability â€” gaussienne animÃ©e (Ïƒ qui respire)
    function makeStabilityWidget(id){
      const c=document.getElementById(id); if(!c) return ()=>{};
      let g=prepCanvas(c);
      function resize(){ g=prepCanvas(c); }
      window.addEventListener('resize',resize);

      return function draw(now){
        const {ctx,cssW,cssH}=g;
        ctx.clearRect(0,0,cssW,cssH);
        ctx.fillStyle='#0b0f10'; ctx.fillRect(0,0,cssW,cssH);

        const mu=cssW*0.55; // centre lÃ©gÃ¨rement Ã  droite (Fractus < Plonk)
        const sigma= (METRICS.stability + Math.sin(now*0.002)*0.2) * 0.9; // respire un peu
        const scale=cssW/160; // km -> px (approx)

        // courbe
        ctx.beginPath();
        for(let x=0;x<cssW;x++){
          const km=(x-mu)/(scale);
          const y=Math.exp(-(km*km)/(2*sigma*sigma));
          const yy=cssH-10 - y*(cssH*0.65);
          if(x===0) ctx.moveTo(x,yy); else ctx.lineTo(x,yy);
        }
        ctx.strokeStyle='rgba(127,255,212,0.85)'; ctx.lineWidth=2; ctx.stroke();

        // marque Ïƒ
        ctx.strokeStyle='rgba(255,255,255,0.18)'; ctx.setLineDash([4,4]);
        ctx.beginPath(); ctx.moveTo(mu,10); ctx.lineTo(mu,cssH-10); ctx.stroke();
        ctx.setLineDash([]);
      };
    }

    // 4) Efficiency â€” anneau / jauge rotative
    function makeEfficiencyWidget(id){
      const c=document.getElementById(id); if(!c) return ()=>{};
      let g=prepCanvas(c);
      function resize(){ g=prepCanvas(c); }
      window.addEventListener('resize',resize);

      return function draw(now){
        const {ctx,cssW,cssH}=g;
        ctx.clearRect(0,0,cssW,cssH);
        ctx.fillStyle='#0b0f10'; ctx.fillRect(0,0,cssW,cssH);

        const r=Math.min(cssW,cssH)*0.32;
        const cx=cssW*0.18 + r + 10, cy=cssH*0.52;
        // anneau base
        ctx.beginPath(); ctx.arc(cx,cy,r,0,Math.PI*2);
        ctx.strokeStyle='rgba(127,255,212,0.12)'; ctx.lineWidth=10; ctx.stroke();

        // valeur -> arc
        const v=clamp(METRICS.efficiency,1.0,1.4);
        const a0=-Math.PI*0.75, a1=a0 + (v-1.0)/(0.4) * (Math.PI*1.5);
        ctx.beginPath(); ctx.arc(cx,cy,r,a0,a1);
        ctx.strokeStyle='rgba(127,255,212,0.9)'; ctx.lineWidth=10; ctx.stroke();

        // tick rotatif subtil
        const tick=a0 + (now*0.002 % (Math.PI*1.5));
        ctx.beginPath(); ctx.arc(cx,cy,r,tick-0.05,tick+0.05);
        ctx.strokeStyle='rgba(255,255,255,0.4)'; ctx.lineWidth=10; ctx.stroke();

        // texte Ã  droite
        ctx.fillStyle='#9adfce'; ctx.font='12px ui-sans-serif';
        ctx.fillText(`Ã— ${v.toFixed(2)} efficiency`, cx+r+18, cy+4);
      };
    }

    // CrÃ©e les 4 widgets
    const widgets = [
      makeBenchWidget('c_bench'),
      makeEntropyWidget('c_entropy'),
      makeStabilityWidget('c_stability'),
      makeEfficiencyWidget('c_eff')
    ].filter(Boolean);

    // Boucle unique
    function loop(now){
      for(const w of widgets) w(now||performance.now());
      requestAnimationFrame(loop);
    }
    requestAnimationFrame(loop);

    /* ---------- FRACTAL WHEEL (inchangÃ©) ---------- */
    const canvas=document.getElementById("fractusCanvas");
    let ctxF=null,wF=0,hF=0;
    function initFractal(){
      const res=prepCanvas(canvas,Math.min(window.innerWidth*0.9,720),400);
      ctxF=res.ctx;wF=res.cssW;hF=res.cssH;
    }
    window.addEventListener("resize",initFractal);
    initFractal();

    function drawFractal(){
      if(!ctxF){requestAnimationFrame(drawFractal);return;}
      ctxF.clearRect(0,0,wF,hF);
      const eNorm=clamp((METRICS.entropy-0.028)/(0.045-0.028),0,1);
      const radius=50+Math.sin(performance.now()*0.003)*(8*eNorm+2);
      const grad=ctxF.createRadialGradient(wF/2,hF/2,0,wF/2,hF/2,radius+80);
      grad.addColorStop(0,`rgba(127,255,212,${0.10+0.15*eNorm})`);
      grad.addColorStop(1,"rgba(0,0,0,0)");
      ctxF.fillStyle=grad;ctxF.beginPath();
      ctxF.arc(wF/2,hF/2,radius+80,0,Math.PI*2);ctxF.fill();
      const rings=9,baseR=40,stepR=35,N=12;
      for(let i=0;i<rings;i++){
        const r=baseR+i*stepR+Math.sin(performance.now()*0.002+i)*2;
        ctxF.beginPath();
        ctxF.strokeStyle=`hsl(${(i*28+performance.now()*0.02)%360},80%,70%)`;
        ctxF.lineWidth=1.1;
        ctxF.arc(wF/2,hF/2,r,0,Math.PI*2);ctxF.stroke();
      }
      const speed=lerp(0.6,1.4,eNorm);
      for(let i=0;i<N;i++){
        const a=performance.now()*0.001*speed+i*0.52;
        const r=baseR+(i%(rings-2))*stepR;
        const x=wF/2+Math.cos(a)*r,y=hF/2+Math.sin(a)*r;
        ctxF.beginPath();
        ctxF.fillStyle=i%3===0?'#7fffd4':(i%3===1?'#80c0ff':'#ffe680');
        ctxF.arc(x,y,3,0,Math.PI*2);ctxF.fill();
      }
      requestAnimationFrame(drawFractal);
    }
    requestAnimationFrame(drawFractal);

    /* ---------- micro-variations rÃ©alistes (monitor) ---------- */
    setInterval(()=>{
      const oldE=METRICS.entropy;     METRICS.entropy   = clamp(oldE + (Math.random()-0.5)*0.002, 0.028, 0.045);
      const oldC=METRICS.coherence;   METRICS.coherence = clamp(oldC + (Math.random()-0.5)*0.15, 97.0, 99.0);
      const oldF=METRICS.efficiency;  METRICS.efficiency= clamp(oldF + (Math.random()-0.5)*0.004, 1.28, 1.32);
      const oldS=METRICS.stability;   METRICS.stability = clamp(oldS + (Math.random()-0.5)*0.12, 90.0, 91.0);
      writeLegends();
    },1500);

    /* ---------- placeholders logs (visuel simple) ---------- */
    function miniBar(id){
      const c=document.getElementById(id); if(!c)return;
      let g=prepCanvas(c);
      function resize(){ g=prepCanvas(c); }
      window.addEventListener('resize',resize);
      (function draw(){
        const {ctx,cssW,cssH}=g;
        ctx.clearRect(0,0,cssW,cssH); ctx.fillStyle='#0b0f10'; ctx.fillRect(0,0,cssW,cssH);
        const pad=12, a=97+Math.sin(performance.now()*0.0009)*1.0, b=95+Math.cos(performance.now()*0.0008)*1.0;
        const max=Math.max(a,b)*1.15;
        ctx.fillStyle='rgba(255,80,80,0.85)'; ctx.fillRect(pad,cssH*0.62,(b/max)*(cssW-pad*2),20);
        ctx.fillStyle='rgba(127,255,212,0.9)'; ctx.fillRect(pad,cssH*0.62-30,(a/max)*(cssW-pad*2),20);
        requestAnimationFrame(draw);
      })();
    }
    miniBar('c_log_rate'); miniBar('c_log_fp'); miniBar('c_log_latency'); miniBar('c_log_acc');
  });
  </script>
</body>
</html>


